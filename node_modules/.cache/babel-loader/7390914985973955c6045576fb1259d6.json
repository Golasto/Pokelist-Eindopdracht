{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Matteus\\\\Desktop\\\\School codes\\\\React\\\\Huiswerk\\\\pokelist\\\\src\\\\context\\\\authProvider.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useState, useEffect } from 'react';\nimport axios from \"axios\";\nimport jwt_decode from \"jwt-decode\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext({});\nfunction AuthContextProvider(_ref) {\n  _s();\n  let {\n    children\n  } = _ref;\n  const [isAuth, toggleIsAuth] = useState({\n    isAuth: false,\n    user: {\n      username: null,\n      email: null\n    }\n  });\n  const [isLoaded, setIsLoaded] = useState(false);\n  const key = localStorage.getItem('key');\n  function login() {\n    console.log('Gebruiker is ingelogd!');\n    toggleIsAuth({\n      isAuth: true\n    });\n  }\n  function logout() {\n    console.log('Gebruiker is uitgelogd!');\n    localStorage.setItem(\"key\", \"\");\n    toggleIsAuth({\n      isAuth: false,\n      user: {\n        username: null,\n        password: null\n      }\n    });\n  }\n  async function getData() {\n    const decripted_key = jwt_decode(key);\n    const data = {\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\",\n        Authorization: \"Bearer \" + key\n      }\n    };\n    try {\n      const response = await axios.get(\"https://frontend-educational-backend.herokuapp.com/api/auth/user\" + decripted_key.sub, data, {\n        withCredentials: false\n      });\n      toggleIsAuth({\n        username: response.data.username,\n        email: response.data.email,\n        isAuth: true\n      });\n      console.log(response.data);\n      setIsLoaded(true);\n    } catch (e) {\n      console.error(e.response);\n      setIsLoaded(true);\n    }\n  }\n  const contextData = {\n    isAuth: isAuth,\n    login: login,\n    logout: logout,\n    getData: getData\n  };\n  useEffect(() => {\n    if (key !== \"\" && key !== null && key !== undefined) {\n      getData().then(r => {});\n    } else {\n      setIsLoaded(true);\n    }\n  }, []);\n  if (!isLoaded) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 16\n    }, this);\n  }\n  if (isLoaded) {\n    return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n      value: contextData,\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 13\n    }, this);\n  }\n}\n_s(AuthContextProvider, \"QTx9Mlz12reQ+D4yNLVxvbKvbHo=\");\n_c = AuthContextProvider;\nexport default AuthContextProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthContextProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","axios","jwt_decode","AuthContext","AuthContextProvider","children","isAuth","toggleIsAuth","user","username","email","isLoaded","setIsLoaded","key","localStorage","getItem","login","console","log","logout","setItem","password","getData","decripted_key","data","headers","Authorization","response","get","sub","withCredentials","e","error","contextData","undefined","then","r"],"sources":["C:/Users/Matteus/Desktop/School codes/React/Huiswerk/pokelist/src/context/authProvider.js"],"sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\r\nimport  axios  from \"axios\";\r\nimport jwt_decode from \"jwt-decode\";\r\n\r\nexport const AuthContext = createContext({});\r\n\r\nfunction AuthContextProvider({ children }) {\r\n    const [isAuth, toggleIsAuth] = useState({\r\n        isAuth: false,\r\n        user: {\r\n            username: null,\r\n            email: null,\r\n        }\r\n    });\r\n\r\n    const [isLoaded, setIsLoaded] = useState(false)\r\n    const key = localStorage.getItem('key')\r\n\r\n    function login() {\r\n        console.log('Gebruiker is ingelogd!');\r\n        toggleIsAuth({isAuth: true});\r\n    }\r\n\r\n    function logout() {\r\n        console.log('Gebruiker is uitgelogd!');\r\n        localStorage.setItem(\"key\",\"\")\r\n        toggleIsAuth({isAuth: false, user: {username: null, password: null}});\r\n    }\r\n\r\n    async function getData() {\r\n\r\n        const decripted_key = jwt_decode(key);\r\n        const data = {\r\n            headers: {\r\n                \"Content-Type\": \"application/x-www-form-urlencoded\",\r\n                Authorization: \"Bearer \" + key,\r\n            }\r\n        }\r\n        try {\r\n            const response = await axios.get(\"https://frontend-educational-backend.herokuapp.com/api/auth/user\" + decripted_key.sub, data, {withCredentials: false})\r\n            toggleIsAuth({ username: response.data.username, email: response.data.email, isAuth: true })\r\n            console.log(response.data)\r\n            setIsLoaded(true)\r\n        } catch (e) {\r\n            console.error(e.response)\r\n            setIsLoaded(true)\r\n        }\r\n    }\r\n\r\n    const contextData = {\r\n        isAuth: isAuth,\r\n        login: login,\r\n        logout: logout,\r\n        getData: getData,\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (key !== \"\" && key !== null && key !== undefined)  {\r\n            getData().then(r => {});\r\n        } else {\r\n            setIsLoaded(true)\r\n        }\r\n    }, [])\r\n\r\n    if (!isLoaded) {\r\n        return <div>Loading...</div>\r\n    } if (isLoaded) {\r\n        return (\r\n            <AuthContext.Provider value={contextData}>\r\n                {children}\r\n            </AuthContext.Provider>\r\n        );\r\n    }\r\n}\r\n\r\nexport default AuthContextProvider;"],"mappings":"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"},"metadata":{},"sourceType":"module"}