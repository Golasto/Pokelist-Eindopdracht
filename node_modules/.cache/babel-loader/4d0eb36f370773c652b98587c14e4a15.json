{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Matteus\\\\Desktop\\\\School codes\\\\React\\\\Huiswerk\\\\pokelist\\\\src\\\\context\\\\authProvider.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useState, useEffect } from 'react';\nimport axios from \"axios\";\nimport jwt_decode from \"jwt-decode\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext({});\nfunction AuthContextProvider(_ref) {\n  _s();\n  let {\n    children\n  } = _ref;\n  const [isAuth, toggleIsAuth] = useState({\n    isAuth: false,\n    user: {\n      username: null,\n      email: null\n    }\n  });\n  const [isLoaded, setIsLoaded] = useState(false);\n  const key = localStorage.getItem('key');\n  function login() {\n    console.log('Gebruiker is ingelogd!');\n    toggleIsAuth({\n      isAuth: true\n    });\n  }\n  function logout() {\n    console.log('Gebruiker is uitgelogd!');\n    localStorage.setItem(\"key\", \"\");\n    toggleIsAuth({\n      isAuth: false,\n      user: {\n        username: null,\n        password: null\n      }\n    });\n  }\n  async function getData() {\n    const token = localStorage.getItem(\"key\");\n    try {\n      const response = await axios.get(\"https://frontend-educational-backend.herokuapp.com/api/user\", {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"Authorization\": `Bearer ${token}`\n        }\n      });\n      if (token) {\n        const decoded = jwt_decode(token);\n        AuthContextProvider(decoded.sub, token);\n      } else {\n        toggleIsAuth({\n          isAuth: false,\n          user: null\n        });\n      }\n      toggleIsAuth({\n        username: response.data.username,\n        email: response.data.email,\n        isAuth: true\n      });\n      console.log(response.data);\n      setIsLoaded(true);\n    } catch (e) {\n      console.error(e.response);\n      setIsLoaded(true);\n    }\n  }\n  const contextData = {\n    isAuth: isAuth,\n    login: login,\n    logout: logout\n    //getData: getData,\n  };\n\n  useEffect(() => {\n    if (key !== \"\" && key !== null) {\n      getData();\n    } else {\n      setIsLoaded(true);\n    }\n  }, []);\n\n  //if (!isLoaded) {\n  // return <div>Loading...</div>\n  //} if (isLoaded) {\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: contextData,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 13\n  }, this);\n  //}\n}\n_s(AuthContextProvider, \"QTx9Mlz12reQ+D4yNLVxvbKvbHo=\");\n_c = AuthContextProvider;\nexport default AuthContextProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthContextProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","axios","jwt_decode","AuthContext","AuthContextProvider","children","isAuth","toggleIsAuth","user","username","email","isLoaded","setIsLoaded","key","localStorage","getItem","login","console","log","logout","setItem","password","getData","token","response","get","headers","decoded","sub","data","e","error","contextData"],"sources":["C:/Users/Matteus/Desktop/School codes/React/Huiswerk/pokelist/src/context/authProvider.js"],"sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\r\nimport  axios  from \"axios\";\r\nimport jwt_decode from \"jwt-decode\";\r\n\r\nexport const AuthContext = createContext({});\r\n\r\nfunction AuthContextProvider({ children }) {\r\n    const [isAuth, toggleIsAuth] = useState({\r\n        isAuth: false,\r\n        user: {\r\n            username: null,\r\n            email: null,\r\n        }\r\n    });\r\n\r\n    const [isLoaded, setIsLoaded] = useState(false)\r\n    const key = localStorage.getItem('key')\r\n\r\n    function login() {\r\n        console.log('Gebruiker is ingelogd!');\r\n        toggleIsAuth({isAuth: true});\r\n    }\r\n\r\n    function logout() {\r\n        console.log('Gebruiker is uitgelogd!');\r\n        localStorage.setItem(\"key\",\"\")\r\n        toggleIsAuth({isAuth: false, user: {username: null, password: null}});\r\n    }\r\n\r\n    async function getData() {\r\n        const token = localStorage.getItem(\"key\")\r\n\r\n\r\n        try {\r\n            const response = await axios.get(\"https://frontend-educational-backend.herokuapp.com/api/user\",\r\n                {\r\n                    headers: {\r\n                        \"Content-Type\": \"application/json\",\r\n                        \"Authorization\": `Bearer ${token}`,\r\n                    }\r\n                })\r\n\r\n            if (token) {\r\n                const decoded = jwt_decode(token);\r\n                AuthContextProvider(decoded.sub, token);\r\n            } else {\r\n                toggleIsAuth({\r\n                    isAuth: false,\r\n                    user: null,\r\n                });\r\n            }\r\n            toggleIsAuth({ username: response.data.username, email: response.data.email, isAuth: true })\r\n            console.log(response.data)\r\n            setIsLoaded(true)\r\n        } catch (e) {\r\n            console.error(e.response)\r\n            setIsLoaded(true)\r\n        }\r\n    }\r\n\r\n    const contextData = {\r\n        isAuth: isAuth,\r\n        login: login,\r\n        logout: logout,\r\n        //getData: getData,\r\n    };\r\n\r\n    useEffect(() => {\r\n        if (key !== \"\" && key !== null)  {\r\n            getData();\r\n        } else {\r\n            setIsLoaded(true)\r\n        }\r\n    }, []) \r\n\r\n    //if (!isLoaded) {\r\n       // return <div>Loading...</div>\r\n    //} if (isLoaded) {\r\n        return (\r\n            <AuthContext.Provider value={contextData}>\r\n                {children}\r\n            </AuthContext.Provider>\r\n        );\r\n    //}\r\n}\r\n\r\nexport default AuthContextProvider;"],"mappings":"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"},"metadata":{},"sourceType":"module"}