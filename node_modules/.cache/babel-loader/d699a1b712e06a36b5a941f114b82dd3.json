{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Matteus\\\\Desktop\\\\School codes\\\\React\\\\Huiswerk\\\\pokelist\\\\src\\\\context\\\\AuthContext.js\";\nimport { createContext, useEffect, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport jwt_decode from \"jwt-decode\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext({});\nfunction AuthContex(_ref) {\n  var _s = $RefreshSig$();\n  let {\n    children\n  } = _ref;\n  function AuthContext(_ref2) {\n    _s();\n    let {\n      children\n    } = _ref2;\n    const [auth, toggleAuth] = useState({\n      isAuth: false,\n      user: {\n        username: null,\n        email: null\n      }\n    });\n    const navigate = useNavigate();\n    useEffect(() => {\n      const storedToken = localStorage.getItem('token');\n      if (storedToken) {\n        const decodedToken = jwt_decode(storedToken);\n        if (Math.floor(Date.now() / 1000) < decodedToken.exp) {\n          console.log(\"De gebruiker is NOG STEEDS ingelogd\");\n          void fetchUserData(storedToken, decodedToken.sub);\n        } else {\n          console.log(\"De token is verlopen\");\n          localStorage.removeItem('token');\n        }\n      } else {\n        setAuth({\n          ...auth,\n          isAuth: false,\n          user: null,\n          status: \"done\"\n        });\n      }\n    }, []);\n    function login(jwt) {\n      console.log(\"Gebruiker is ingelogd!\");\n      localStorage.setItem('token', jwt);\n      const decodedToken = jwt_decode(jwt);\n      void fetchUserData(jwt, decodedToken.sub, \"/\");\n    }\n    async function getData() {\n      const token = localStorage.getItem(\"key\");\n      try {\n        const response = await axios.get(\"https://frontend-educational-backend.herokuapp.com/api/user\", {\n          headers: {\n            \"Content-Type\": \"application/json\",\n            \"Authorization\": `Bearer ${token}`\n          }\n        });\n        if (token) {\n          const decoded = jwt_decode(token);\n          AuthContextProvider(decoded.sub, token);\n        } else {\n          toggleAuth({\n            isAuth: false,\n            user: null\n          });\n        }\n        toggleAuth({\n          username: response.data.username,\n          email: response.data.email,\n          isAuth: true\n        });\n        console.log(response.data);\n        setIsLoaded(true);\n      } catch (e) {\n        console.error(e.response);\n        setIsLoaded(true);\n      }\n    }\n    const contextData = {\n      isAuth: auth,\n      login: login,\n      logout: logout,\n      getData: getData\n    };\n    function logout() {\n      console.log(\" Gebruiker is uitgelogd\");\n      localStorage.removeItem('token');\n      setAuth({\n        ...auth,\n        isAuth: false,\n        user: null,\n        status: \"done\"\n      });\n      navigate(\"/\");\n    }\n\n    // const contextData = {\n    //     isAuth: auth.isAuth,\n    //     user: auth.user,\n    //     status: auth.status,\n    //     login: login,\n    //     logout: logout\n    // }\n\n    return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n      value: contextData,\n      children: auth.status === \"done\" ? children : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Loading...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 54\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 13\n    }, this);\n  }\n  _s(AuthContext, \"3Lqjwt+VRvya8V7rVnHHZEZiRnI=\", false, function () {\n    return [useNavigate];\n  });\n}\n_c = AuthContex;\nvar _c;\n$RefreshReg$(_c, \"AuthContex\");","map":{"version":3,"names":["createContext","useEffect","useState","useNavigate","jwt_decode","axios","AuthContext","AuthContex","children","auth","toggleAuth","isAuth","user","username","email","navigate","storedToken","localStorage","getItem","decodedToken","Math","floor","Date","now","exp","console","log","fetchUserData","sub","removeItem","setAuth","status","login","jwt","setItem","getData","token","response","get","headers","decoded","AuthContextProvider","data","setIsLoaded","e","error","contextData","logout"],"sources":["C:/Users/Matteus/Desktop/School codes/React/Huiswerk/pokelist/src/context/AuthContext.js"],"sourcesContent":["import { createContext, useEffect, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport jwt_decode from \"jwt-decode\";\r\nimport axios from \"axios\";\r\n\r\nexport const AuthContext = createContext({} );\r\n\r\nfunction AuthContex( { children } ) {\r\n\r\n    function AuthContext({children}) {\r\n        const [auth, toggleAuth] = useState({\r\n            isAuth: false,\r\n            user: {\r\n                username: null,\r\n                email: null,\r\n            }\r\n        });\r\n        const navigate = useNavigate()\r\n\r\n        useEffect(() => {\r\n            const storedToken = localStorage.getItem('token')\r\n\r\n            if (storedToken) {\r\n                const decodedToken = jwt_decode(storedToken)\r\n\r\n                if (Math.floor(Date.now() / 1000) < decodedToken.exp) {\r\n                    console.log(\"De gebruiker is NOG STEEDS ingelogd\")\r\n                    void fetchUserData(storedToken, decodedToken.sub)\r\n                } else {\r\n                    console.log(\"De token is verlopen\")\r\n                    localStorage.removeItem('token')\r\n                }\r\n            } else {\r\n                setAuth({\r\n                    ...auth,\r\n                    isAuth: false,\r\n                    user: null,\r\n                    status: \"done\"\r\n                })\r\n            }\r\n        }, [])\r\n\r\n        function login(jwt) {\r\n            console.log(\"Gebruiker is ingelogd!\")\r\n            localStorage.setItem('token', jwt)\r\n            const decodedToken = jwt_decode(jwt);\r\n\r\n            void fetchUserData(jwt, decodedToken.sub, \"/\")\r\n        }\r\n\r\n        async function getData() {\r\n            const token = localStorage.getItem(\"key\")\r\n\r\n\r\n            try {\r\n                const response = await axios.get(\"https://frontend-educational-backend.herokuapp.com/api/user\",\r\n                    {\r\n                        headers: {\r\n                            \"Content-Type\": \"application/json\",\r\n                            \"Authorization\": `Bearer ${token}`,\r\n                        }\r\n                    })\r\n\r\n                if (token) {\r\n                    const decoded = jwt_decode(token);\r\n                    AuthContextProvider(decoded.sub, token);\r\n                } else {\r\n                    toggleAuth({\r\n                        isAuth: false,\r\n                        user: null,\r\n                    });\r\n                }\r\n                toggleAuth({username: response.data.username, email: response.data.email, isAuth: true})\r\n                console.log(response.data)\r\n                setIsLoaded(true)\r\n            } catch (e) {\r\n                console.error(e.response)\r\n                setIsLoaded(true)\r\n            }\r\n        }\r\n\r\n        const contextData = {\r\n            isAuth: auth,\r\n            login: login,\r\n            logout: logout,\r\n            getData: getData,\r\n        };\r\n\r\n        function logout() {\r\n            console.log(\" Gebruiker is uitgelogd\")\r\n            localStorage.removeItem('token')\r\n            setAuth({\r\n                ...auth,\r\n                isAuth: false,\r\n                user: null,\r\n                status: \"done\"\r\n            })\r\n            navigate(\"/\")\r\n        }\r\n\r\n        // const contextData = {\r\n        //     isAuth: auth.isAuth,\r\n        //     user: auth.user,\r\n        //     status: auth.status,\r\n        //     login: login,\r\n        //     logout: logout\r\n        // }\r\n\r\n        return (\r\n            <AuthContext.Provider value={contextData}>\r\n                {auth.status === \"done\" ? children : <p>Loading...</p>}\r\n            </AuthContext.Provider>\r\n        )\r\n    }\r\n\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}