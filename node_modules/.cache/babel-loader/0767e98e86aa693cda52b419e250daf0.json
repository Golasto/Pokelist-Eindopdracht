{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Matteus\\\\Desktop\\\\School codes\\\\React\\\\Huiswerk\\\\pokelist\\\\src\\\\context\\\\authProvider.js\",\n  _s = $RefreshSig$();\nimport React, { createContext, useState, useEffect } from 'react';\nimport axios from \"axios\";\nimport jwt_decode from \"jwt-decode\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AuthContext = /*#__PURE__*/createContext({});\nfunction AuthContextProvider(_ref) {\n  _s();\n  let {\n    children\n  } = _ref;\n  const [isAuth, toggleIsAuth] = useState({\n    isAuth: false,\n    user: {\n      username: null,\n      email: null\n    }\n  });\n  const [isLoaded, setIsLoaded] = useState(false);\n  const key = localStorage.getItem('key');\n  const navigate = useNavigate();\n  function login() {\n    console.log('Gebruiker is ingelogd!');\n    toggleIsAuth({\n      isAuth: true\n    });\n    navigate('/');\n  }\n  function logout() {\n    console.log('Gebruiker is uitgelogd!');\n    localStorage.setItem(\"key\", \"\");\n    toggleIsAuth({\n      isAuth: false,\n      user: {\n        username: null,\n        password: null\n      }\n    });\n    navigate('/');\n  }\n  async function getData() {\n    const token = localStorage.getItem(\"key\");\n    try {\n      const response = await axios.get(\"https://frontend-educational-backend.herokuapp.com/api/user\", {\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"Authorization\": `Bearer ${token}`\n        }\n      });\n      if (token) {\n        const decoded = jwt_decode(token);\n        AuthContextProvider(decoded.sub, token);\n      } else {\n        toggleIsAuth({\n          isAuth: false,\n          user: null\n        });\n      }\n      toggleIsAuth({\n        username: response.data.username,\n        email: response.data.email,\n        isAuth: true\n      });\n      console.log(response.data);\n      setIsLoaded(true);\n    } catch (e) {\n      console.error(e.response);\n      setIsLoaded(true);\n    }\n  }\n  const contextData = {\n    isAuth: isAuth,\n    login: login,\n    logout: logout\n    //getData: getData,\n  };\n\n  /*useEffect(() => {\r\n      if (key !== \"\" && key !== null)  {\r\n          getData();\r\n      } else {\r\n          setIsLoaded(true)\r\n      }\r\n  }, []) */\n\n  //if (!isLoaded) {\n  // return <div>Loading...</div>\n  //} if (isLoaded) {\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: contextData,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 13\n  }, this);\n  //}\n}\n_s(AuthContextProvider, \"BQ8NGkJjtCuc4e7CCtxjxiNOTz0=\", false, function () {\n  return [useNavigate];\n});\n_c = AuthContextProvider;\nexport default AuthContextProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthContextProvider\");","map":{"version":3,"names":["React","createContext","useState","useEffect","axios","jwt_decode","useNavigate","AuthContext","AuthContextProvider","children","isAuth","toggleIsAuth","user","username","email","isLoaded","setIsLoaded","key","localStorage","getItem","navigate","login","console","log","logout","setItem","password","getData","token","response","get","headers","decoded","sub","data","e","error","contextData"],"sources":["C:/Users/Matteus/Desktop/School codes/React/Huiswerk/pokelist/src/context/authProvider.js"],"sourcesContent":["import React, { createContext, useState, useEffect } from 'react';\r\nimport  axios  from \"axios\";\r\nimport jwt_decode from \"jwt-decode\";\r\nimport {useNavigate} from \"react-router-dom\";\r\n\r\nexport const AuthContext = createContext({});\r\n\r\nfunction AuthContextProvider({ children }) {\r\n    const [isAuth, toggleIsAuth] = useState({\r\n        isAuth: false,\r\n        user: {\r\n            username: null,\r\n            email: null,\r\n        }\r\n    });\r\n\r\n    const [isLoaded, setIsLoaded] = useState(false)\r\n    const key = localStorage.getItem('key')\r\n    const navigate = useNavigate()\r\n\r\n    function login() {\r\n        console.log('Gebruiker is ingelogd!');\r\n        toggleIsAuth({isAuth: true});\r\n        navigate('/')\r\n    }\r\n\r\n    function logout() {\r\n        console.log('Gebruiker is uitgelogd!');\r\n        localStorage.setItem(\"key\",\"\")\r\n        toggleIsAuth({isAuth: false, user: {username: null, password: null}});\r\n        navigate('/')\r\n    }\r\n\r\n    async function getData() {\r\n        const token = localStorage.getItem(\"key\")\r\n\r\n\r\n        try {\r\n            const response = await axios.get(\"https://frontend-educational-backend.herokuapp.com/api/user\",\r\n                {\r\n                    headers: {\r\n                        \"Content-Type\": \"application/json\",\r\n                        \"Authorization\": `Bearer ${token}`,\r\n                    }\r\n                })\r\n\r\n            if (token) {\r\n                const decoded = jwt_decode(token);\r\n                AuthContextProvider(decoded.sub, token);\r\n            } else {\r\n                toggleIsAuth({\r\n                    isAuth: false,\r\n                    user: null,\r\n                });\r\n            }\r\n            toggleIsAuth({ username: response.data.username, email: response.data.email, isAuth: true })\r\n            console.log(response.data)\r\n            setIsLoaded(true)\r\n        } catch (e) {\r\n            console.error(e.response)\r\n            setIsLoaded(true)\r\n        }\r\n    }\r\n\r\n    const contextData = {\r\n        isAuth: isAuth,\r\n        login: login,\r\n        logout: logout,\r\n        //getData: getData,\r\n    };\r\n\r\n    /*useEffect(() => {\r\n        if (key !== \"\" && key !== null)  {\r\n            getData();\r\n        } else {\r\n            setIsLoaded(true)\r\n        }\r\n    }, []) */\r\n\r\n    //if (!isLoaded) {\r\n       // return <div>Loading...</div>\r\n    //} if (isLoaded) {\r\n        return (\r\n            <AuthContext.Provider value={contextData}>\r\n                {children}\r\n            </AuthContext.Provider>\r\n        );\r\n    //}\r\n}\r\n\r\nexport default AuthContextProvider;"],"mappings":"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"},"metadata":{},"sourceType":"module"}